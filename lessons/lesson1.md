# Диагностика производительности

### Perf
Позволяет выявлять компоненты, которые перерисовываются без причины. Позволяет анализировать время рендера компонентов.

*Демо:* Запуск неоптимизированного короткого приложения с списком элементов, вывод таблицы производительности.

### Developer Tools
Позволяет: 
- проводить глубокий анализ кода
- анализировать производительности
- анализировать потребления памяти
- отображение перерендера
- дебаг 
- пользоваться React расширением хрома
- пользоваться Redux расширением хрома
- отображать хранилище redux
- условные точки остановки

*Демо:* Показать основной функционал из списка, рассказать как использовать на практике, научить проводить отладку приложений без изменения кода

### Console
- console.time
- console.assert
- console.group
- console.log
- console.profile
- console.trace
*Демо:* Добавление отладочных сообщений без изменения кода

### Использование window.perfomance
Позволяет в коде ставить метки с названием компонента или страницы для более удобного анализа производительности

### FPS Meter
Позволяет вовремя диагностировать падение производительности, особенно при scroll, websocket

### Пропатченный connect
Отображает все случае бесполезного перерендера контейнера с `@connect` функцией при изменённом `props`, который изменился по ссылке, но остался прежним по содержанию

# Ускоряем время старта приложения на React

### NODE_ENV === 'production'
Ускорение производительности при NODE_ENV === 'production', за счёт внутренней оптимизации, минификации кода и стилей, отключения части функционала дебага и вывода ошибок и предупреждений.
Внутренние оптимизации внутри React при production через плагины: https://krambertech.github.io/react-perf-talk/assets/player/KeynoteDHTMLPlayer.html#10:
– React Constant Elements Transform - перенос вёрстки в константы
– React Inline Elements Transform
– React RemovePropTypes Transform
– Transform Pure Class To Function - объяснить, что делать это вручную уже не требуется
– React optimize preset

### Указать версии поддерживаемых браузеров
Если их не указать, то будет очень много полифилов и оптимизаций для старых браузеров

### Минифицировать CSS
Указать версии IE, чтобы уменьшить кол-во префиксов в стилях

### Source Map Explorer
NPM пакет, позволяет визуально показать содержимое bundle и понять, какие npm пакеты импортированы неоптимально или зря. Можно провести оптимизацию, например отключив лишние локали, импортируя функции, а не пакеты целиком при помощи Modular import. Рассказать что такое Webpack Tree Shaking

### Eslint 
Позволит найти и исправить все неоптимальные места в коде и поддерживать код в рамках установленных правил

### Extract CSS
Выделить CSS файлы для каждого бандла

### React router
Выделить код в bundle для каждого элемента url, подгружать код только когда он понадобился.

# Причины плохой производительности React и методы исправления

### Изменившиеся ссылки в props при том же содержимом
Рассмотрим все варианты изменения props, которые можно было избежать:
- функции
- списки
– хранилища
– запросы в сеть и другие асинхронные операции
– кэширование фильтрации, отбора и сортировки элементов в браузере

Инструменты, которыми можно избежать бесполезных перерендеров:
– asyncConnect, позволит отложить первый рендер до загрузки всех данных с сети
– серверный рендеринг SSR (в том числе группирует загрузку всех данных с сети)
– preventRenderWhileLoading
- оптимизация использования state
- глубокое понимание lifecycle Реакт компонентов
– stateless component
– pureComponent

### Недостаточное разбиение на компоненты и контейнеры
– Если компонент имеющий состояние (например контейнер), написан внутри большого компонента, то он будет перерендериваться. 
– Контейнеры должны брать только те данные, которые им нужны
– Приём, когда один контейнер управляет только списком с id, а отображают строки уже другие контейнеры, получающие id как `prop`
– Рассказать про иерархию перерендера, в том числе при PureComponents


# Причины плохой производительности Redux и методы исправления
Инструменты исправления:
– reselect
– memoizee
– передача в коннект mapDispatchToProps

# Улучшение читаемости и увеличение переиспользования функций и компонентов
Инструменты:
– High Order Reducer
– High Order Functions
– High Order Components
– Комбинирование компонентов с переиспользованием функций и стилей
– Перенос и переиспользование компонентов и библиотек компонентов в отдельные npm пакеты
– Принципы SOLID в react приложениях

# Ускорение написания кода, использование шаблонизатора компонентов
